!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define([],t):"object"==typeof exports?exports.arithmetiny=t():e.arithmetiny=t()}(this,(function(){return(()=>{"use strict";var e={119:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(t,n){this.evalChildren=function(t,n){for(var r=t.map((function(){return NaN})),o=0;o<t.length;o++){for(var a=t[o],i=a.toEval,u=0,l=a.children;u<l.length;u++){var c=l[u];if(e.neededBranches.has(c.id)&&(r[o]=c.eval(i),!isNaN(r[o]))){if(o+1===r.length)return n.apply(void 0,r);break}}if(isNaN(r[o]))return NaN}return NaN},this.regex=t,this.id=n}return e.IDENTIFIER_RE=/^([a-zA-Z_][\w]{0,31})$/,e.neededBranches=new Set,e}();t.default=n},221:function(e,t,n){var r,o=this&&this.__extends||(r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])},r(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var a=n(119),i=function(e){function t(t,n){var r=e.call(this,/^([a-zA-Z_][\w]{0,31})(\(.*\))$/,"FUNCTION")||this;if(r.fnContext=new Map([["ln",Math.log],["log",function(e,t){return Math.log(e)/Math.log(t)}],["sin",Math.sin],["cos",Math.cos],["tan",Math.tan],["sqrt",Math.sqrt],["abs",Math.abs]]),r.argsConflict=function(e,t){return e.length>1?e.length!==t:/^\s*$/.test(e[0])?0!==t:1!==t},r.parMatch=function(e){for(var t=0,n=0,r=0;r<e.length&&t>=0;r++){var o=e.codePointAt(r);40===o?t++:41===o&&(t--,n=r)}return 0===t?n:-1},r.eval=function(e){var t=r.regex.exec(e);if(t){var n=r.parMatch(t[2]);if(n>=1){var o=r.fnContext.get(t[1]),a=t[2].substring(1,n);if(o){var i=a.split(/ *, */);if(r.argsConflict(i,o.length))throw Error("Function ".concat(t[1]," expected ").concat(o.length," argument(s), got ").concat(i.length,': "').concat(a,'"'));if(0===o.length)return o();var u=i.map((function(e){return{toEval:e,children:r.children}}));return r.evalChildren(u,o)}throw new Error('Function "'.concat(t[1],'" is not defined'))}}return NaN},r.children=t,n)for(var o=0,i=n;o<i.length;o++){var u=i[o],l=u.name,c=u.fn;if(!a.default.IDENTIFIER_RE.test(l))throw new Error('Given function "'.concat(l,'" has an invalid identifier.'));r.fnContext.set(l,c)}return r}return o(t,e),t}(a.default);t.default=i},607:function(e,t,n){var r=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(o,a){function i(e){try{l(r.next(e))}catch(e){a(e)}}function u(e){try{l(r.throw(e))}catch(e){a(e)}}function l(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(i,u)}l((r=r.apply(e,t||[])).next())}))},o=this&&this.__generator||function(e,t){var n,r,o,a,i={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return a={next:u(0),throw:u(1),return:u(2)},"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function u(a){return function(u){return function(a){if(n)throw new TypeError("Generator is already executing.");for(;i;)try{if(n=1,r&&(o=2&a[0]?r.return:a[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,a[1])).done)return o;switch(r=0,o&&(a=[2&a[0],o.value]),a[0]){case 0:case 1:o=a;break;case 4:return i.label++,{value:a[1],done:!1};case 5:i.label++,r=a[1],a=[0];continue;case 7:a=i.ops.pop(),i.trys.pop();continue;default:if(!((o=(o=i.trys).length>0&&o[o.length-1])||6!==a[0]&&2!==a[0])){i=0;continue}if(3===a[0]&&(!o||a[1]>o[0]&&a[1]<o[3])){i.label=a[1];break}if(6===a[0]&&i.label<o[1]){i.label=o[1],o=a;break}if(o&&i.label<o[2]){i.label=o[2],i.ops.push(a);break}o[2]&&i.ops.pop(),i.trys.pop();continue}a=t.call(e,i)}catch(e){a=[6,e],r=0}finally{n=o=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}([a,u])}}},a=this&&this.__spreadArray||function(e,t,n){if(n||2===arguments.length)for(var r,o=0,a=t.length;o<a;o++)!r&&o in t||(r||(r=Array.prototype.slice.call(t,0,o)),r[o]=t[o]);return e.concat(r||Array.prototype.slice.call(t))};Object.defineProperty(t,"__esModule",{value:!0}),t.Arithmetiny=void 0;var i=n(119),u=n(221),l=n(59),c=n(603),f=function(){function e(t){var n=this;this.setUpGrammar=function(e){var t,r=function(e){return e},o=/^(.+)$/,i=new l.default(/^(.+)\+(.+)$/,(function(e,t){return e+t}),"ADD"),f=new l.default(/^(.+?)\+(.+)$/,(function(e,t){return e+t}),"ADD_RIGHT"),s=new l.default(/^(.+)-(.+)$/,(function(e,t){return e-t}),"SUB"),d=new l.default(/^(.+?)-(.+)$/,(function(e,t){return e-t}),"SUB_RIGHT"),h=new l.default(o,r,"AS_DOWN"),p=[i,f,s,d,h],v=new l.default(/^(.+)\*(.+)$/,(function(e,t){return e*t}),"MULT"),y=new l.default(/^(.+?)\*(.+)$/,(function(e,t){return e*t}),"MULT_RIGHT"),_=new l.default(/^(.+)\/(.+)$/,(function(e,t){return e/t}),"DIV"),w=new l.default(/^(.+?)\/(.+)$/,(function(e,t){return e/t}),"DIV_RIGHT"),g=new l.default(/^(.+)%(.+)$/,(function(e,t){return e%t}),"MOD"),N=new l.default(/^(.+?)%(.+)$/,(function(e,t){return e%t}),"MOD_RIGHT"),b=new l.default(o,r,"MMD_DOWN"),E=[v,y,_,w,g,N,b],x=new l.default(/^(.+)\^(.+)$/,Math.pow,"EXP"),M=new l.default(/^(.+?)\^(.+)$/,Math.pow,"EXP_RIGHT"),I=new l.default(o,r,"EXP_DOWN"),O=[x,M,I],D=new l.default(/^\((.+)\)$/,r,"PAREN"),T=new l.default(/^-(?!-.+)(.+)$/,(function(e){return-e}),"NEGATIVE"),R=[D,T,new l.default(/^[0-9]*\.?[0-9]+([eE][-+]?[0-9]+)?$/,r,"NUMBER"),new c.default(e&&e.vars),new u.default(p,e&&e.functions)];n.populateBinaryRules(p,E,i,f,s,d),h.addChildren.apply(h,a([1],E,!1)),n.populateBinaryRules(E,O,v,y,_,w,g,N),b.addChildren.apply(b,a([1],O,!1)),n.populateBinaryRules(R,O,x,M),I.addChildren.apply(I,a([1],R,!1)),D.addChildren.apply(D,a([1],p,!1)),T.addChildren.apply(T,a([1],p,!1)),(t=n.topLevel).push.apply(t,p)},this.setContext=function(e){n.topLevel.length=0,n.setUpGrammar(e)},this.evaluate=function(e){return r(n,void 0,void 0,(function(){var t=this;return o(this,(function(n){return[2,Promise.resolve().then((function(){i.default.neededBranches.clear(),t.fillNeededBranches(e),e=e.replace(/\s+/g,"");for(var n=0,r=t.topLevel;n<r.length;n++){var o=r[n].eval(e);if(!isNaN(o))return o}return NaN}))]}))}))},this.fillNeededBranches=function(t){for(var n=0,r=t;n<r.length;n++){var o=r[n],a=e.symbolToID.get(o);a&&a.forEach((function(e){return i.default.neededBranches.add(e)}))}i.default.neededBranches.add("AS_DOWN"),i.default.neededBranches.add("MMD_DOWN"),i.default.neededBranches.add("EXP_DOWN"),i.default.neededBranches.add("NUMBER"),i.default.neededBranches.add("VAR")},this.populateBinaryRules=function(e,t){for(var n=[],r=2;r<arguments.length;r++)n[r-2]=arguments[r];n.forEach((function(n){n.addChildren.apply(n,a([1],e,!1)),n.addChildren.apply(n,a([2],t,!1))}))},this.topLevel=[],this.setUpGrammar(t)}return e.symbolToID=new Map([["+",["ADD","ADD_RIGHT"]],["-",["SUB","SUB_RIGHT","NEGATIVE"]],["*",["MULT","MULT_RIGHT"]],["/",["DIV","DIV_RIGHT"]],["%",["MOD","MOD_RIGHT"]],["^",["EXP","EXP_RIGHT"]],["(",["PAREN","FUNCTION"]]]),e}();t.Arithmetiny=f},59:function(e,t,n){var r,o=this&&this.__extends||(r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])},r(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var a=function(e){function t(t,n,r){var o=e.call(this,t,r)||this;return o.addChildren=function(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];o.children.push({groupInd:e,children:t})},o.eval=function(e){var t=o.regex.exec(e);if(t){if(0===o.children.length)return+e;var n=o.children.map((function(e){var n=e.children,r=e.groupInd;return{children:n,toEval:t[r]}}));return o.evalChildren(n,o.fn)}return NaN},o.children=[],o.fn=n,o}return o(t,e),t}(n(119).default);t.default=a},603:function(e,t,n){var r,o=this&&this.__extends||(r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])},r(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var a=n(119),i=function(e){function t(t){var n=e.call(this,a.default.IDENTIFIER_RE,"VAR")||this;if(n.varContext=new Map([["e",Math.E],["pi",Math.PI]]),n.eval=function(e){var t=n.regex.exec(e);if(t){var r=n.varContext.get(t[1]);if(void 0!==r)return r;throw new Error('Variable "'.concat(t[1],'" is not defined.'))}return NaN},t)for(var r=0,o=t;r<o.length;r++){var i=o[r],u=i.name,l=i.value;if(!n.regex.test(u))throw new Error('Given variable "'.concat(u,'" has an invalid identifier.'));n.varContext.set(u,l)}return n}return o(t,e),t}(a.default);t.default=i}},t={};return function n(r){var o=t[r];if(void 0!==o)return o.exports;var a=t[r]={exports:{}};return e[r].call(a.exports,a,a.exports,n),a.exports}(607)})()}));