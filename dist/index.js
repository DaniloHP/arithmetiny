!function(t,n){"object"==typeof exports&&"object"==typeof module?module.exports=n():"function"==typeof define&&define.amd?define([],n):"object"==typeof exports?exports.arithmetiny=n():t.arithmetiny=n()}(this,(function(){return(()=>{"use strict";var t={d:(n,r)=>{for(var e in r)t.o(r,e)&&!t.o(n,e)&&Object.defineProperty(n,e,{enumerable:!0,get:r[e]})},o:(t,n)=>Object.prototype.hasOwnProperty.call(t,n),r:t=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})}},n={};t.r(n),t.d(n,{Arithmetiny:()=>s});const r=function(t,n){var r=this;this.allNotNaN=function(t){for(var n=0,r=t;n<r.length;n++){var e=r[n];if(isNaN(e))return!1}return!0},this.toString=function(){return r.id},this.regex=t,this.id=n};var e,o=(e=function(t,n){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,n){t.__proto__=n}||function(t,n){for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])},e(t,n)},function(t,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)});const a=function(t){function n(r){var e=t.call(this,/^ *([a-zA-Z_][\w]{0,31})\(([+\-*/^%\w ,()]+)\) *$/,"FUNCTION")||this;return e.evaluate=function(t){var r=e.regex.exec(t);if(t.length>0&&null!==r){var o=r[1],a=r[2].trim(),i=n.fnContext.get(o);if(i){var l=a.split(/ *, */);if(l.length!==i.length)throw Error("Function ".concat(o," expected ").concat(i.length," argument(s), got ").concat(l.length));for(var u=new Array(l.length).fill(NaN),c=0,f=0,p=l;f<p.length;f++){for(var h=p[f],s=0,y=e.children;s<y.length;s++){var v=y[s].evaluate(h);if(!isNaN(v)){if(u[c]=v,e.allNotNaN(u))return i.apply(void 0,u);break}}if(isNaN(u[c]))return NaN;c++}}}return NaN},e.children=r,e}return o(n,t),n.fnContext=new Map([["floor",Math.floor],["ceil",Math.ceil],["ln",Math.log],["log10",Math.log10],["log",function(t,n){return Math.log(t)/Math.log(n)}],["sin",Math.sin],["cos",Math.cos],["tan",Math.tan],["sqrt",Math.sqrt],["abs",Math.abs]]),n}(r);var i=function(){var t=function(n,r){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,n){t.__proto__=n}||function(t,n){for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])},t(n,r)};return function(n,r){if("function"!=typeof r&&null!==r)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");function e(){this.constructor=n}t(n,r),n.prototype=null===r?Object.create(r):(e.prototype=r.prototype,new e)}}(),l=function(t){function n(n,r,e){var o=t.call(this,n,e)||this;return o.addChildren=function(t){for(var n=[],r=1;r<arguments.length;r++)n[r-1]=arguments[r];o.children.push({groupInd:t,children:n})},o.evaluate=function(t){var n=o.regex.exec(t);if(t.length>0&&null!==n){var r=o.children.length;if(0===r)return+t;for(var e=new Array(r).fill(NaN),a=0,i=0,l=o.children;i<l.length;i++){for(var u=l[i],c=u.groupInd,f=u.children,p=n[c],h=0,s=f;h<s.length;h++){var y=s[h].evaluate(p);if(!isNaN(y)){if(e[a]=y,o.allNotNaN(e))return o.fn.apply(o,e);break}}if(isNaN(e[a]))return NaN;a++}}return NaN},o.children=[],o.fn=r,o}return i(n,t),n}(r);const u=l;var c=function(){var t=function(n,r){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,n){t.__proto__=n}||function(t,n){for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])},t(n,r)};return function(n,r){if("function"!=typeof r&&null!==r)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");function e(){this.constructor=n}t(n,r),n.prototype=null===r?Object.create(r):(e.prototype=r.prototype,new e)}}(),f=function(t){function n(){for(var r=[],e=0;e<arguments.length;e++)r[e]=arguments[e];var o=t.call(this,/^ *([a-zA-Z_][\w]{0,31}) *$/,"VAR")||this;o.evaluate=function(t){var r=o.regex.exec(t);if(t.length>0&&null!==r){var e=r[0],a=n.varContext.get(e);if(void 0!==a)return a}return NaN};for(var a=0,i=r;a<i.length;a++){var l=i[a],u=l[0],c=l[1];n.varContext.set(u,c)}return o}return c(n,t),n.varContext=new Map([["e",Math.E],["pi",Math.PI]]),n}(r);const p=f;var h=function(t,n,r){if(r||2===arguments.length)for(var e,o=0,a=n.length;o<a;o++)!e&&o in n||(e||(e=Array.prototype.slice.call(n,0,o)),e[o]=n[o]);return t.concat(e||Array.prototype.slice.call(n))},s=function(){var t=this;this.evaluate=function(n){for(var r=0,e=t.levels[0];r<e.length;r++){var o=e[r].evaluate(n);if(!isNaN(o))return o}return NaN},this.populateBinaryRules=function(t,n){for(var r=[],e=2;e<arguments.length;e++)r[e-2]=arguments[e];r.forEach((function(r){r.addChildren.apply(r,h([1],t,!1)),r.addChildren.apply(r,h([2],n,!1))}))};var n=function(t){return t},r=/^ *(.*) *$/,e=new u(/^ *(.*) *\+ *(.*) *$/,(function(t,n){return t+n}),"ADD"),o=new u(/^ *(.*?) *\+ *(.*) *$/,(function(t,n){return t+n}),"ADD_RIGHT"),i=new u(/^ *(.*) *- *(.*) *$/,(function(t,n){return t-n}),"SUB"),l=new u(/^ *(.*?) *- *(.*) *$/,(function(t,n){return t-n}),"SUB_RIGHT"),c=new u(r,n,"AS_DOWN"),f=[e,o,i,l,c],s=new u(/^ *(.*) *\* *(.*) *$/,(function(t,n){return t*n}),"MULT"),y=new u(/^ *(.*?) *\* *(.*) *$/,(function(t,n){return t*n}),"MULT_RIGHT"),v=new u(/^ *(.*) *\/ *(.*) *$/,(function(t,n){return t/n}),"DIV"),d=new u(/^ *(.*?) *\/ *(.*) *$/,(function(t,n){return t/n}),"DIV_RIGHT"),g=new u(/^ *(.*) *% *(.*) *$/,(function(t,n){return t%n}),"MOD"),N=new u(/^ *(.*?) *% *(.*) *$/,(function(t,n){return t%n}),"MOD_RIGHT"),w=new u(r,n,"MMD_DOWN"),_=[s,y,v,d,g,N,w],O=new u(/^ *(.*) *\^ *(.*) *$/,Math.pow,"EXP"),M=new u(/^ *(.*?) *\^ *(.*) *$/,Math.pow,"EXP_RIGHT"),b=new u(r,n,"EXP_DOWN"),x=[O,M,b],A=new u(/^ *\((.*)\) *$/,n,"PAREN"),C=new u(/^ *-(.*) *$/,(function(t){return-t}),"NEGATIVE"),$=[A,C,new u(/^ *\d+ *$/,n,"SCALAR"),new p,new a(f)];this.populateBinaryRules(f,_,e,o,i,l),c.addChildren.apply(c,h([1],_,!1)),this.populateBinaryRules(_,x,s,y,v,d,g,N),w.addChildren.apply(w,h([1],x,!1)),this.populateBinaryRules($,x,O,M),b.addChildren.apply(b,h([1],$,!1)),A.addChildren.apply(A,h([1],f,!1)),C.addChildren.apply(C,h([1],f,!1)),this.levels=[f,_,x,$]};return n})()}));